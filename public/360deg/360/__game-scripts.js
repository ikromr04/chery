var MouseInput=pc.createScript("mouseInput");MouseInput.attributes.add("orbitSensitivity",{type:"number",default:.3,title:"Orbit Sensitivity",description:"How fast the camera moves around the orbit. Higher is faster"}),MouseInput.attributes.add("distanceSensitivity",{type:"number",default:.15,title:"Distance Sensitivity",description:"How fast the camera moves in and out. Higher is faster"}),MouseInput.prototype.initialize=function(){if(this.orbitCamera=this.entity.script.orbitCamera,this.orbitCamera){var t=this,onMouseOut=function(o){t.onMouseOut(o)};this.app.mouse.on(pc.EVENT_MOUSEDOWN,this.onMouseDown,this),this.app.mouse.on(pc.EVENT_MOUSEUP,this.onMouseUp,this),this.app.mouse.on(pc.EVENT_MOUSEMOVE,this.onMouseMove,this),this.app.mouse.on(pc.EVENT_MOUSEWHEEL,this.onMouseWheel,this),window.addEventListener("mouseout",onMouseOut,!1),this.on("destroy",(function(){this.app.mouse.off(pc.EVENT_MOUSEDOWN,this.onMouseDown,this),this.app.mouse.off(pc.EVENT_MOUSEUP,this.onMouseUp,this),this.app.mouse.off(pc.EVENT_MOUSEMOVE,this.onMouseMove,this),this.app.mouse.off(pc.EVENT_MOUSEWHEEL,this.onMouseWheel,this),window.removeEventListener("mouseout",onMouseOut,!1)}))}this.app.mouse.disableContextMenu(),this.lookButtonDown=!1,this.panButtonDown=!1,this.lastPoint=new pc.Vec2},MouseInput.fromWorldPoint=new pc.Vec3,MouseInput.toWorldPoint=new pc.Vec3,MouseInput.worldDiff=new pc.Vec3,MouseInput.prototype.pan=function(t){var o=MouseInput.fromWorldPoint,e=MouseInput.toWorldPoint,i=MouseInput.worldDiff,s=this.entity.camera,n=this.orbitCamera.distance;s.screenToWorld(t.x,t.y,n,o),s.screenToWorld(this.lastPoint.x,this.lastPoint.y,n,e),i.sub2(e,o),this.orbitCamera.pivotPoint.add(i)},MouseInput.prototype.onMouseDown=function(t){switch(t.button){case pc.MOUSEBUTTON_LEFT:this.lookButtonDown=!0;break;case pc.MOUSEBUTTON_MIDDLE:}},MouseInput.prototype.onMouseUp=function(t){switch(t.button){case pc.MOUSEBUTTON_LEFT:this.lookButtonDown=!1;break;case pc.MOUSEBUTTON_MIDDLE:}},MouseInput.prototype.onMouseMove=function(t){pc.app.mouse;this.lookButtonDown?(this.orbitCamera.pitch-=t.dy*this.orbitSensitivity,this.orbitCamera.yaw-=t.dx*this.orbitSensitivity):this.panButtonDown&&this.pan(t),this.lastPoint.set(t.x,t.y)},MouseInput.prototype.onMouseWheel=function(t){this.orbitCamera.distance-=t.wheel*this.distanceSensitivity*(.1*this.orbitCamera.distance),t.event.preventDefault()},MouseInput.prototype.onMouseOut=function(t){this.lookButtonDown=!1,this.panButtonDown=!1};var KeyboardInput=pc.createScript("keyboardInput");KeyboardInput.prototype.initialize=function(){this.orbitCamera=this.entity.script.orbitCamera},KeyboardInput.prototype.postInitialize=function(){this.orbitCamera&&(this.startDistance=this.orbitCamera.distance,this.startYaw=this.orbitCamera.yaw,this.startPitch=this.orbitCamera.pitch,this.startPivotPosition=this.orbitCamera.pivotPoint.clone())},KeyboardInput.prototype.update=function(t){this.orbitCamera&&this.app.keyboard.wasPressed(pc.KEY_SPACE)&&(this.orbitCamera.reset(this.startYaw,this.startPitch,this.startDistance),this.orbitCamera.pivotPoint=this.startPivotPosition)};var AutoDistance=pc.createScript("autoDistance");AutoDistance.attributes.add("defaultDist",{type:"number",default:4}),AutoDistance.attributes.add("zDist",{type:"number",default:3.3}),AutoDistance.attributes.add("xDist",{type:"number",default:2.2}),AutoDistance.attributes.add("parentMovement",{type:"number",default:1.5}),AutoDistance.attributes.add("speed",{type:"number",default:1}),AutoDistance.attributes.add("distMult",{type:"number",default:1}),AutoDistance.attributes.add("minFov",{type:"number",default:1,title:"最小视觉",min:0,max:90}),AutoDistance.attributes.add("maxFov",{type:"number",default:1,title:"最大视觉",max:90,min:0}),AutoDistance.prototype.initialize=function(){this.weight=1,this.cam=this.entity.camera.camera,this.cam.horizontalFov=!0,this.mult=(this.maxFov-this.minFov)/8,this.distance=pc.math.lerp(this.minFov,this.maxFov,.5),this.targetDistance=this.distance,this.lpos2=new pc.Vec3,this.app._autoDistance=this},AutoDistance.prototype.postUpdate=function(t){if(this.enabled){var i=t*this.speed*this.weight,s=this.entity.forward,e=Math.abs(s.z),a=Math.abs(s.x),o=Math.abs(s.y),n=this.smoothstep(this.defaultDist,this.xDist,a);n=this.smoothstep(n,this.zDist,e)*this.distMult;var h=this.entity.getLocalPosition();h.z=this.smoothstep(h.z,n,i),this.entity.setLocalPosition(h),this.lpos2.z=this.smoothstep(this.lpos2.z,-s.z*this.parentMovement,i),this.lpos2.y=this.smoothstep(this.lpos2.y,s.y*(1.25*o+1)*(o*-e+1),i),this.entity.getParent().setPosition(this.lpos2),this.distance=pc.math.lerp(this.distance,this.targetDistance,t/.2),this.cam.fov=this.distance}},AutoDistance.prototype.smoothstep=function(t,i,s){return s=s*s*(3-2*s),pc.math.lerp(t,i,s)},AutoDistance.prototype.onMouseWheel=function(t){var i=t*-this.mult;this.targetDistance+=i,this.targetDistance<this.minFov?this.targetDistance=this.minFov:this.targetDistance>this.maxFov&&(this.targetDistance=this.maxFov)},AutoDistance.prototype.startFovScale=function(){},AutoDistance.prototype.camFovScale=function(t){this.targetDistance-=.1*t,this.targetDistance=pc.math.clamp(this.targetDistance,this.minFov,this.maxFov)};var MouseLook=pc.createScript("mouseLook");MouseLook.attributes.add("weight",{type:"number",default:1}),MouseLook.attributes.add("sensivity",{type:"number",default:.25}),MouseLook.attributes.add("easing",{type:"number",default:.2}),MouseLook.attributes.add("maxPitchUp",{type:"number",default:25}),MouseLook.attributes.add("maxPitchDown",{type:"number",default:25}),MouseLook.prototype.postInitialize=function(){this.oldQuat=new pc.Quat,this.app._mouseLook=this,window.addEventListener("mousedown",this.onMouseDown.bind(this)),window.addEventListener("mousemove",this.onMouseMove.bind(this)),window.addEventListener("mouseup",this.onMouseUp.bind(this)),window.addEventListener("touchstart",this.onTouchStart.bind(this)),window.addEventListener("touchmove",this.onTouchMove.bind(this)),window.addEventListener("touchend",this.onTouchEnd.bind(this)),this.augmentEntity=this.app.root.findByTag("hotsPoint"),this.rotating=!1,this.pitch=0,this.yaw=0,this.pitchTarget=0,this.yawTarget=0,this.m={x:0,y:0},this.ml={x:0,y:0},this.touchInd=-1,this.enabled=!1},MouseLook.prototype.onMouseDown=function(t){"CANVAS"==t.target.tagName&&(this.app.currAug&&!this.app.currAug.buttonEventDown(new pc.Vec2(t.clientX,t.clientY))?"3dui-canvas"===t.target.id&&this.app.currAug.close():(this.rotating=!0,this.m.x=t.clientX,this.m.y=t.clientY,this.ml.x=this.m.x,this.ml.y=this.m.y),t.preventDefault(),t.stopPropagation())},MouseLook.prototype.onMouseMove=function(t){this.m.x=t.clientX,this.m.y=t.clientY},MouseLook.prototype.onMouseUp=function(t){this.rotating=!1},MouseLook.prototype.onTouchStart=function(t){if("CANVAS"==t.target.tagName&&-1===this.touchInd&&t.touches.length){var i=t.touches[0];this.app.currAug&&!this.app.currAug.buttonEventDown(new pc.Vec2(i.clientX,i.clientY))?"3dui-canvas"==t.target.id&&this.app.currAug.close():(this.rotating=!0,this.touchInd=i.identifier,this.m.x=i.clientX,this.m.y=i.clientY,this.ml.x=this.m.x,this.ml.y=this.m.y),t.stopPropagation()}},MouseLook.prototype.onTouchMove=function(t){for(var i=0;i<t.changedTouches.length;i++){var o=t.changedTouches[i];if(o.identifier===this.touchInd)return this.m.x=o.clientX,void(this.m.y=o.clientY)}},MouseLook.prototype.onTouchEnd=function(t){this.rotating=!1,this.touchInd=-1},MouseLook.prototype.update=function(t){if(this.enabled){if(this.rotating){var i=this.ml.x-this.m.x,o=this.ml.y-this.m.y;i*=-.25,o*=-.25,this.pitchTarget=Math.max(-this.maxPitchUp,Math.min(this.maxPitchDown,this.pitchTarget+o*this.sensivity*this.weight)),this.yawTarget+=i*this.sensivity*this.weight,this.ml.x=this.m.x,this.ml.y=this.m.y}this.pitch+=(this.pitchTarget-this.pitch)*this.easing,this.yaw+=(this.yawTarget-this.yaw)*this.easing,this.oldQuat.copy(this.entity.getRotation()),this.entity.setEulerAngles(this.pitch,this.yaw+180,0),this.oldQuat.slerp(this.oldQuat,this.entity.getRotation(),this.weight),this.entity.setRotation(this.oldQuat)}};var MainButton=pc.createScript("mainButton");MainButton.prototype.initialize=function(){this.entity.element.on("click",this.onPress,this),this.entity.element.on("touchstart",this.onTouch,this),this.deng=!0;this.change=0},MainButton.prototype.update=function(e){},MainButton.prototype.click_color=function(e){e.element.texture!==this.app.assets.find("颜色选中.png").resource?(e.element.texture=this.app.assets.find("颜色选中.png").resource,pc.app.root.findByName("color_menu").enabled=!0):(e.element.texture=this.app.assets.find("颜色.png").resource,pc.app.root.findByName("color_menu").enabled=!1)},MainButton.prototype.click_light=function(e){var s=this.app.assets.find("waiguanxianshi02","material").resource,t=this.app.assets.find("waiguanxianshi","material").resource;e.element.texture!==this.app.assets.find("灯光选中.png").resource?(e.element.texture=this.app.assets.find("灯光选中.png").resource,this.app.fire("deng:toggle",!0),this.app.assets.find("houbeimen05.glb","model").resource.meshInstances[9].material=s,this.app.assets.find("waiguan.glb","model").resource.meshInstances[10].material=s,this.app.assets.find("zhumen01.glb","model").resource.meshInstances[9].material=s,this.app.assets.find("zhumen02.glb","model").resource.meshInstances[9].material=s,s.update(),pc.app.root.findByName("color").element.texture=this.app.assets.find("颜色.png").resource,pc.app.root.findByName("color_menu").enabled=!1,this.app.scene.skyboxIntensity=.5,this.app.assets.find("changjing01","material").resource.emissiveIntensity=.1,this.app.assets.find("changjing01","material").resource.update()):(e.element.texture=this.app.assets.find("灯光.png").resource,this.app.fire("deng:toggle",!1),this.app.assets.find("houbeimen05.glb","model").resource.meshInstances[9].material=t,this.app.assets.find("waiguan.glb","model").resource.meshInstances[10].material=t,this.app.assets.find("zhumen01.glb","model").resource.meshInstances[9].material=t,this.app.assets.find("zhumen02.glb","model").resource.meshInstances[9].material=t,t.update(),this.app.scene.skyboxIntensity=1,this.app.assets.find("changjing01","material").resource.emissiveIntensity=.3,this.app.assets.find("changjing01","material").resource.update())},MainButton.prototype.click_door=function(e){e.element.texture!==this.app.assets.find("5门开关选中d.png").resource?(e.element.texture=this.app.assets.find("5门开关选中d.png").resource,this.app.root.findByName("zuoqianmen").script.hotspot.zuoqianmen_kaiguan%2==0&&pc.app.root.findByName("zuoqianmen").script.hotspot.open_zuoqianmen(!0),this.app.root.findByName("zuohoumen").script.hotspot.zuohoumen_kaiguan%2==0&&pc.app.root.findByName("zuohoumen").script.hotspot.open_zuohoumen(!0),this.app.root.findByName("youqianmen").script.hotspot.youqianmen_kaiguan%2==0&&pc.app.root.findByName("youqianmen").script.hotspot.open_youqianmen(!0),this.app.root.findByName("youhoumen").script.hotspot.youhoumen_kaiguan%2==0&&pc.app.root.findByName("youhoumen").script.hotspot.open_youhoumen(!0),this.app.root.findByName("houbeimen").script.hotspot.houbeimen_kaiguan%2==0&&1==this.app.root.findByName("p_chenggan01").animation.speed&&pc.app.root.findByName("houbeimen").script.hotspot.open_houbeimen(!0),pc.app.root.findByName("color").element.texture=this.app.assets.find("颜色.png").resource,pc.app.root.findByName("color_menu").enabled=!1):(e.element.texture=this.app.assets.find("5门开关.png").resource,this.app.root.findByName("zuoqianmen").script.hotspot.zuoqianmen_kaiguan%2==1&&pc.app.root.findByName("zuoqianmen").script.hotspot.open_zuoqianmen(!1),this.app.root.findByName("zuohoumen").script.hotspot.zuohoumen_kaiguan%2==1&&pc.app.root.findByName("zuohoumen").script.hotspot.open_zuohoumen(!1),this.app.root.findByName("youqianmen").script.hotspot.youqianmen_kaiguan%2==1&&pc.app.root.findByName("youqianmen").script.hotspot.open_youqianmen(!1),this.app.root.findByName("youhoumen").script.hotspot.youhoumen_kaiguan%2==1&&pc.app.root.findByName("youhoumen").script.hotspot.open_youhoumen(!1),this.app.root.findByName("houbeimen").script.hotspot.houbeimen_kaiguan%2==1&&0==this.app.root.findByName("p_chenggan01").animation.speed&&pc.app.root.findByName("houbeimen").script.hotspot.open_houbeimen(!1))},MainButton.prototype.onPress=function(e){var s=this.entity;switch(s.name){case"color":pc.app.root.findByName("NEISHI").element.texture==this.app.assets.find("内饰.png").resource&&this.click_color(pc.app.root.findByName("color")),pc.app.root.findByName("light").element.texture==this.app.assets.find("灯光选中.png").resource&&this.click_light(pc.app.root.findByName("light")),pc.app.root.findByName("door").element.texture==this.app.assets.find("5门开关选中d.png").resource&&this.click_door(pc.app.root.findByName("door"));break;case"light":pc.app.root.findByName("door").element.texture==this.app.assets.find("5门开关选中d.png").resource&&this.click_door(pc.app.root.findByName("door")),pc.app.root.findByName("color").element.texture==this.app.assets.find("颜色选中.png").resource&&this.click_color(pc.app.root.findByName("color")),pc.app.root.findByName("NEISHI").element.texture==this.app.assets.find("内饰.png").resource&&this.click_light(pc.app.root.findByName("light"));break;case"door":pc.app.root.findByName("NEISHI").element.texture==this.app.assets.find("内饰.png").resource&&this.click_door(pc.app.root.findByName("door")),pc.app.root.findByName("color").element.texture==this.app.assets.find("颜色选中.png").resource&&this.click_color(pc.app.root.findByName("color")),pc.app.root.findByName("light").element.texture==this.app.assets.find("灯光选中.png").resource&&this.click_light(pc.app.root.findByName("light"));break;case"fenweideng":pc.app.root.findByName("fenweideng").element.texture!=this.app.assets.find("氛围灯选中.png").resource?(pc.app.root.findByName("fenweideng").element.texture=this.app.assets.find("氛围灯选中.png").resource,pc.app.assets.find("360_material","material").resource.emissiveMap=pc.app.assets.find("CHERY_T19_LEFT_neishi_blue.jpg","texture").resource,pc.app.assets.find("360_material","material").resource.update()):(pc.app.root.findByName("fenweideng").element.texture=this.app.assets.find("氛围灯.png").resource,pc.app.assets.find("360_material","material").resource.emissiveMap=pc.app.assets.find("CHERY_T19_LEFT_neishi.jpg","texture").resource,pc.app.assets.find("360_material","material").resource.update());break;case"waiguan":pc.app.root.findByName("fenweideng").element.texture==this.app.assets.find("氛围灯选中.png").resource&&(pc.app.root.findByName("fenweideng").element.texture=this.app.assets.find("氛围灯.png").resource,pc.app.assets.find("360_material","material").resource.emissiveMap=pc.app.assets.find("CHERY_T19_LEFT_neishi.jpg","texture").resource,pc.app.assets.find("360_material","material").resource.update()),pc.app.root.findByName("waiguan").element.texture=this.app.assets.find("外观选中.png").resource,this.change%2==0&&(console.log("成功"),pc.app.root.findByName("360Camera").script.changingScenes.loadScene("Main")),this.change++;break;case"white":if(s.element.texture!==this.app.assets.find("白色选中.png").resource){s.element.texture=this.app.assets.find("白色选中.png").resource,pc.app.root.findByName("red").element.texture=this.app.assets.find("红色.png").resource,pc.app.root.findByName("blue_gray").element.texture=this.app.assets.find("蓝灰.png").resource,pc.app.root.findByName("gray").element.texture=this.app.assets.find("灰色.png").resource,pc.app.root.findByName("black").element.texture=this.app.assets.find("黑色.png").resource,pc.app.root.findByName("blue").element.texture=this.app.assets.find("蓝色.png").resource;var t=this.app.assets.find("cheqi01","material");this.app.assets.find("zhumen01.glb","model").resource.meshInstances[6].material=t.resource,this.app.assets.find("zhumen02.glb","model").resource.meshInstances[6].material=t.resource,this.app.assets.find("zhumen03.glb","model").resource.meshInstances[6].material=t.resource,this.app.assets.find("zhumen04.glb","model").resource.meshInstances[6].material=t.resource,this.app.assets.find("houbeimen05.glb","model").resource.meshInstances[4].material=t.resource,this.app.assets.find("waiguan.glb","model").resource.meshInstances[3].material=t.resource}break;case"red":if(s.element.texture!==this.app.assets.find("红色选中.png").resource){s.element.texture=this.app.assets.find("红色选中.png").resource,pc.app.root.findByName("white").element.texture=this.app.assets.find("白色.png").resource,pc.app.root.findByName("blue_gray").element.texture=this.app.assets.find("蓝灰.png").resource,pc.app.root.findByName("gray").element.texture=this.app.assets.find("灰色.png").resource,pc.app.root.findByName("black").element.texture=this.app.assets.find("黑色.png").resource,pc.app.root.findByName("blue").element.texture=this.app.assets.find("蓝色.png").resource;var a=this.app.assets.find("cheqi02","material");this.app.assets.find("zhumen01.glb","model").resource.meshInstances[6].material=a.resource,this.app.assets.find("zhumen02.glb","model").resource.meshInstances[6].material=a.resource,this.app.assets.find("zhumen03.glb","model").resource.meshInstances[6].material=a.resource,this.app.assets.find("zhumen04.glb","model").resource.meshInstances[6].material=a.resource,this.app.assets.find("houbeimen05.glb","model").resource.meshInstances[4].material=a.resource,this.app.assets.find("waiguan.glb","model").resource.meshInstances[3].material=a.resource}break;case"blue_gray":if(s.element.texture!==this.app.assets.find("蓝灰选中.png").resource){s.element.texture=this.app.assets.find("蓝灰选中.png").resource,pc.app.root.findByName("red").element.texture=this.app.assets.find("红色.png").resource,pc.app.root.findByName("white").element.texture=this.app.assets.find("白色.png").resource,pc.app.root.findByName("gray").element.texture=this.app.assets.find("灰色.png").resource,pc.app.root.findByName("black").element.texture=this.app.assets.find("黑色.png").resource,pc.app.root.findByName("blue").element.texture=this.app.assets.find("蓝色.png").resource;var n=this.app.assets.find("cheqi03","material");this.app.assets.find("zhumen01.glb","model").resource.meshInstances[6].material=n.resource,this.app.assets.find("zhumen02.glb","model").resource.meshInstances[6].material=n.resource,this.app.assets.find("zhumen03.glb","model").resource.meshInstances[6].material=n.resource,this.app.assets.find("zhumen04.glb","model").resource.meshInstances[6].material=n.resource,this.app.assets.find("houbeimen05.glb","model").resource.meshInstances[4].material=n.resource,this.app.assets.find("waiguan.glb","model").resource.meshInstances[3].material=n.resource}break;case"gray":if(s.element.texture!==this.app.assets.find("灰色选中.png").resource){s.element.texture=this.app.assets.find("灰色选中.png").resource,pc.app.root.findByName("red").element.texture=this.app.assets.find("红色.png").resource,pc.app.root.findByName("blue_gray").element.texture=this.app.assets.find("蓝灰.png").resource,pc.app.root.findByName("white").element.texture=this.app.assets.find("白色.png").resource,pc.app.root.findByName("black").element.texture=this.app.assets.find("黑色.png").resource,pc.app.root.findByName("blue").element.texture=this.app.assets.find("蓝色.png").resource;var p=this.app.assets.find("cheqi04","material");this.app.assets.find("zhumen01.glb","model").resource.meshInstances[6].material=p.resource,this.app.assets.find("zhumen02.glb","model").resource.meshInstances[6].material=p.resource,this.app.assets.find("zhumen03.glb","model").resource.meshInstances[6].material=p.resource,this.app.assets.find("zhumen04.glb","model").resource.meshInstances[6].material=p.resource,this.app.assets.find("houbeimen05.glb","model").resource.meshInstances[4].material=p.resource,this.app.assets.find("waiguan.glb","model").resource.meshInstances[3].material=p.resource}break;case"black":if(s.element.texture!==this.app.assets.find("黑色选中.png").resource){s.element.texture=this.app.assets.find("黑色选中.png").resource,pc.app.root.findByName("red").element.texture=this.app.assets.find("红色.png").resource,pc.app.root.findByName("blue_gray").element.texture=this.app.assets.find("蓝灰.png").resource,pc.app.root.findByName("gray").element.texture=this.app.assets.find("灰色.png").resource,pc.app.root.findByName("white").element.texture=this.app.assets.find("白色.png").resource,pc.app.root.findByName("blue").element.texture=this.app.assets.find("蓝色.png").resource;var r=this.app.assets.find("cheqi05","material");this.app.assets.find("zhumen01.glb","model").resource.meshInstances[6].material=r.resource,this.app.assets.find("zhumen02.glb","model").resource.meshInstances[6].material=r.resource,this.app.assets.find("zhumen03.glb","model").resource.meshInstances[6].material=r.resource,this.app.assets.find("zhumen04.glb","model").resource.meshInstances[6].material=r.resource,this.app.assets.find("houbeimen05.glb","model").resource.meshInstances[4].material=r.resource,this.app.assets.find("waiguan.glb","model").resource.meshInstances[3].material=r.resource}break;case"blue":if(s.element.texture!==this.app.assets.find("蓝色选中.png").resource){s.element.texture=this.app.assets.find("蓝色选中.png").resource,pc.app.root.findByName("red").element.texture=this.app.assets.find("红色.png").resource,pc.app.root.findByName("blue_gray").element.texture=this.app.assets.find("蓝灰.png").resource,pc.app.root.findByName("gray").element.texture=this.app.assets.find("灰色.png").resource,pc.app.root.findByName("black").element.texture=this.app.assets.find("黑色.png").resource,pc.app.root.findByName("white").element.texture=this.app.assets.find("白色.png").resource;var i=this.app.assets.find("cheqi06","material");this.app.assets.find("zhumen01.glb","model").resource.meshInstances[6].material=i.resource,this.app.assets.find("zhumen02.glb","model").resource.meshInstances[6].material=i.resource,this.app.assets.find("zhumen03.glb","model").resource.meshInstances[6].material=i.resource,this.app.assets.find("zhumen04.glb","model").resource.meshInstances[6].material=i.resource,this.app.assets.find("houbeimen05.glb","model").resource.meshInstances[4].material=i.resource,this.app.assets.find("waiguan.glb","model").resource.meshInstances[3].material=i.resource}break;case"fullscreen":var o=document.body;s.element.texture!==this.app.assets.find("缩小.png","texture").resource?(s.element.texture=this.app.assets.find("缩小.png","texture").resource,o.requestFullscreen?o.requestFullscreen():o.mozRequestFullScreen?o.mozRequestFullScreen():o.webkitRequestFullscreen?o.webkitRequestFullscreen():o.msRequestFullscreen?o.msRequestFullscreen():console.error("浏览器不支持全屏!")):(s.element.texture=this.app.assets.find("全屏.png").resource,document.exitFullscreen?document.exitFullscreen():document.mozCancelFullScreen?document.mozCancelFullScreen():document.webkitExitFullscreen?document.webkitExitFullscreen():document.msExitFullscreen?document.msExitFullscreen():console.error("error!"));break;case"music":s.element.texture!==this.app.assets.find("音乐关闭.png","texture").resource?(s.element.texture=this.app.assets.find("音乐关闭.png","texture").resource,s.sound.pause()):(s.element.texture=this.app.assets.find("音乐.png","texture").resource,s.sound.play("Slot 1"));break;case"NEISHI":this.change%2==0&&(pc.app.root.findByName("light").element.texture==this.app.assets.find("灯光选中.png").resource&&this.click_light(pc.app.root.findByName("light")),pc.app.root.findByName("color").element.texture==this.app.assets.find("颜色选中.png").resource&&this.click_color(pc.app.root.findByName("color")),1==pc.app.root.findByName("houbeimen").enabled&&(pc.app.root.findByName("NEISHI").element.texture=this.app.assets.find("内饰选中.png").resource,pc.app.root.findByName("door").element.texture==this.app.assets.find("5门开关选中d.png").resource?(this.click_door(pc.app.root.findByName("door")),setTimeout((function(){pc.app.root.findByName("MainCamera").script.changingScenes.loadScene("neishi_scene")}),1e3)):1==pc.app.root.findByName("houbeimen").enabled?(this.app.root.findByName("zuoqianmen").script.hotspot.zuoqianmen_kaiguan%2==1&&pc.app.root.findByName("zuoqianmen").script.hotspot.open_zuoqianmen(!1),this.app.root.findByName("zuohoumen").script.hotspot.zuohoumen_kaiguan%2==1&&pc.app.root.findByName("zuohoumen").script.hotspot.open_zuohoumen(!1),this.app.root.findByName("youqianmen").script.hotspot.youqianmen_kaiguan%2==1&&pc.app.root.findByName("youqianmen").script.hotspot.open_youqianmen(!1),this.app.root.findByName("youhoumen").script.hotspot.youhoumen_kaiguan%2==1&&pc.app.root.findByName("youhoumen").script.hotspot.open_youhoumen(!1),this.app.root.findByName("houbeimen").script.hotspot.houbeimen_kaiguan%2==1&&0==this.app.root.findByName("p_chenggan01").animation.speed&&pc.app.root.findByName("houbeimen").script.hotspot.open_houbeimen(!1),setTimeout((function(){pc.app.root.findByName("MainCamera").script.changingScenes.loadScene("neishi_scene")}),1e3)):pc.app.root.findByName("MainCamera").script.changingScenes.loadScene("neishi_scene"))),this.change++}};var Rotation=pc.createScript("rotation");Rotation.attributes.add("sensivity",{type:"number",default:.5}),Rotation.attributes.add("easing",{type:"number",default:.2}),Rotation.attributes.add("maxPitchUp",{type:"number",default:25}),Rotation.attributes.add("maxPitchDown",{type:"number",default:25}),Rotation.attributes.add("autoRotation",{type:"boolean",default:!0,title:"是否自动旋转"}),Rotation.attributes.add("cam",{type:"entity",title:"摄像机"}),Rotation.prototype.initialize=function(){this.weight=1,this.oldQuat=new pc.Quat,this.pitchS=-20,this.yawS=10,this.app.mouse.on(pc.EVENT_MOUSEWHEEL,this.onMouseWheel,this),this.app.mouse.on(pc.EVENT_MOUSEDOWN,this.onMouseDown,this),this.app.mouse.on(pc.EVENT_MOUSEMOVE,this.onMouseMove,this),this.app.mouse.on(pc.EVENT_MOUSEUP,this.onMouseUp,this),window.addEventListener("touchstart",this.onTouchStart.bind(this)),window.addEventListener("touchmove",this.onTouchMove.bind(this)),window.addEventListener("touchend",this.onTouchEnd.bind(this)),this.rotating=!1,this.pitch=.11,this.yaw=this.yawTarget=this.entity.getLocalEulerAngles().y,this.pitchTarget=0,this.m={x:0,y:0},this.ml={x:0,y:0},this.rotateEnd=0,this.touchInd=-1,this.lastPinchDistance=0,this.augmentEntity=this.app.root.findByTag("hotsPoint"),this.app._carPivotRotation=this},Rotation.prototype.onMouseDown=function(t){if(this.enabled&&"CANVAS"===t.event.target.tagName){if(this.app.currAug&&!this.app.currAug.buttonEventDown(new pc.Vec2(t.x,t.y)))return"3dui-canvas"==t.event.target.id&&this.app.currAug.close(),t.event.preventDefault(),void t.event.stopPropagation();this.rotating=!0,this.m.x=t.x,this.m.y=t.y,this.ml.x=this.m.x,this.ml.y=this.m.y}},Rotation.prototype.onMouseMove=function(t){this.m.x=t.x,this.m.y=t.y},Rotation.prototype.onMouseUp=function(t){this.rotating=!1,this.rotateEnd=Date.now()},Rotation.prototype.onMouseWheel=function(t){this.enabled&&(this.cam.script.autoDistance.onMouseWheel(t.wheel),t.event.preventDefault())},Rotation.prototype.onTouchStart=function(t){if(this.enabled&&"CANVAS"===t.target.tagName){var i=t.touches[0];if(!this.app.currAug||this.app.currAug.buttonEventDown(new pc.Vec2(i.clientX,i.clientY))){this.rotating=!0,this.touchInd=i.identifier,this.m.x=i.clientX,this.m.y=i.clientY,this.ml.x=this.m.x,this.ml.y=this.m.y;var e=event.touches;2==e.length&&(this.lastPinchDistance=this.getPinchDistance(e[0],e[1]))}else"3dui-canvas"==t.target.id&&this.app.currAug.close()}},Rotation.prototype.onTouchMove=function(t){var i=t.touches;if(1==i.length){var e=i[0];this.m.x=e.clientX,this.m.y=e.clientY}else if(2==i.length){var s=this.getPinchDistance(i[0],i[1]),n=s-this.lastPinchDistance;this.lastPinchDistance=s,this.cam.script.autoDistance.camFovScale(n)}},Rotation.prototype.onTouchEnd=function(t){this.rotating=!1,this.rotateEnd=Date.now(),this.touchInd=-1},Rotation.prototype.getPinchDistance=function(t,i){var e=t.clientX-i.clientX,s=t.clientY-i.clientY;return Math.sqrt(e*e+s*s)},Rotation.prototype.update=function(t){if(!this.app.currAug){if(this.rotating){var i=this.ml.x-this.m.x,e=this.ml.y-this.m.y;this.pitchTarget=Math.max(-this.maxPitchUp,Math.min(this.maxPitchDown,this.pitchTarget+e*this.sensivity)),this.yawTarget+=i*this.sensivity,this.ml.x=this.m.x,this.ml.y=this.m.y}else Date.now()-this.rotateEnd>1e3&&this.autoRotation&&(this.yawTarget+=10*t*Math.min(1,(Date.now()-this.rotateEnd-1e3)/2e3));Math.abs(this.pitch-this.pitchTarget)+Math.abs(this.yaw-this.yawTarget)>.1&&(this.pitch+=(this.pitchTarget-this.pitch)*this.easing,this.yaw+=(this.yawTarget-this.yaw)*this.easing,this.oldQuat.copy(this.entity.getRotation()),this.entity.setEulerAngles(this.pitch+this.pitchS,this.yaw+this.yawS,0),this.oldQuat.slerp(this.oldQuat,this.entity.getRotation(),this.weight),this.entity.setRotation(this.oldQuat))}};var Car=pc.createScript("car");Car.attributes.add("radius",{type:"number",default:25,title:"轮子半径"}),Car.attributes.add("floor",{type:"entity",title:"地面"}),Car.prototype.initialize=function(){this.wheels=[],this.LoadCar(),this.a=0},Car.prototype.update=function(e){try{var o=this.floor.script.offsetFloor;1/(Math.PI*this.radius*2/100)*(1e4*(-5*o.speed)/60/60)*360*e}catch(e){}},Car.prototype.LoadCar=function(){var e=this,o=[],d=e.app.assets.find("waiguan.glb","model"),n=e.app.assets.find("neishi.glb","model"),a=e.app.assets.find("zhumen01.glb","model"),t=e.app.assets.find("zhumen02.glb","model"),i=e.app.assets.find("zhumen03.glb","model"),l=e.app.assets.find("zhumen04.glb","model"),s=e.app.assets.find("houbeimen05.glb","model"),p=e.app.assets.find("lungu1.glb","model"),r=e.app.assets.find("lungu2.glb","model"),m=e.app.assets.find("tianchuan01.glb","model"),c=e.app.assets.find("tianchuan02.glb","model"),u=e.app.assets.find("chenggan01.glb","model"),h=e.app.assets.find("chenggan02.glb","model"),f=e.app.assets.find("zheguangbanbuchong.glb","model"),y=e.app.assets.find("zheguangbanbuchong2.glb","model"),g=(e.app.assets.find("zhuanpan.glb","model"),e.app.assets.find("zhuzhu.glb","model"));e.app.assets.find("Take 001.glb","animation");g.ready((function(e){var d=new pc.Entity;d.addComponent("model"),d.model.model=g.resource,d.name=g.name;for(var n=0;n<d.children[0].children[0].children.length;n++)o.push(d.children[0].children[0].children[n].getPosition());d.destroy()})),d.ready((function(o){var n=new pc.Entity;n.addComponent("model"),n.model.model=d.resource,e.entity.addChild(n)})),n.ready((function(o){var d=new pc.Entity;d.addComponent("model"),d.model.model=n.resource,e.entity.addChild(d)})),a.ready((function(e){var d=pc.app.root.findByName("p_door01");d.addComponent("model"),d.model.model=a.resource,d.setPosition(o[0].x,o[0].y,o[0].z)})),t.ready((function(e){var d=pc.app.root.findByName("p_door02");d.addComponent("model"),d.model.model=t.resource,d.setPosition(o[1].x,o[1].y,o[1].z)})),i.ready((function(e){var d=pc.app.root.findByName("p_door03");d.addComponent("model"),d.model.model=i.resource,d.setPosition(o[2].x,o[2].y,o[2].z)})),l.ready((function(e){var d=pc.app.root.findByName("p_door04");d.addComponent("model"),d.model.model=l.resource,d.setPosition(o[3].x,o[3].y,o[3].z)})),s.ready((function(e){var d=pc.app.root.findByName("p_houbeimen05");d.addComponent("model"),d.model.model=s.resource,d.setPosition(o[4].x+.012,o[4].y,o[4].z-.012)})),p.ready((function(d){var n=new pc.Entity;n.addComponent("model"),n.model.model=p.resource,e.entity.addChild(n);var a=n.clone();a.model.model=n.model.model.clone(),a.setLocalScale(1,1,-1),e.entity.addChild(a),n.setPosition(o[5]),a.setPosition(o[5].x,o[5].y,-o[5].z),e.wheels.push(n),e.wheels.push(a)})),r.ready((function(d){var n=new pc.Entity;n.addComponent("model"),n.model.model=r.resource,e.entity.addChild(n);var a=n.clone();a.model.model=n.model.model.clone(),a.setLocalScale(1,1,-1),e.entity.addChild(a),n.setPosition(o[6]),a.setPosition(o[6].x,o[6].y,-o[6].z),e.wheels.push(n),e.wheels.push(a)})),m.ready((function(e){var d=pc.app.root.findByName("p_tianchuang01");d.addComponent("model"),d.model.model=m.resource,d.setPosition(o[8].x,o[8].y,o[8].z)})),c.ready((function(e){var d=pc.app.root.findByName("p_tianchuang02");d.addComponent("model"),d.model.model=c.resource,d.setPosition(o[9])})),u.ready((function(e){var d=pc.app.root.findByName("p_chenggan01");d.addComponent("model"),d.model.model=u.resource,d.setPosition(o[10])})),h.ready((function(e){var d=pc.app.root.findByName("p_chenggan02");d.addComponent("model"),d.model.model=h.resource,d.setPosition(o[11])})),f.ready((function(e){var o=pc.app.root.findByName("p_zheguangban");o.addComponent("model"),o.model.model=f.resource})),y.ready((function(e){var o=pc.app.root.findByName("p_zheguangban2");o.addComponent("model"),o.model.model=y.resource}))};var Pulse=pc.createScript("pulse");Pulse.attributes.add("pulseTimeSecs",{type:"number",default:2,title:"Pulse Time Secs"}),Pulse.prototype.initialize=function(){this.secsSinceStart=this.pulseTimeSecs+1,this.entity.on("pulse:start",this.onStartEvent,this)},Pulse.prototype.update=function(t){if(this.secsSinceStart+=t,this.secsSinceStart<=this.pulseTimeSecs){var e=50*this.secsSinceStart/this.pulseTimeSecs,s=.01*(2*Math.abs(e-.5))+.7,i=this.entity.getLocalScale();i.set(s,s,s),this.entity.setLocalScale(i)}},Pulse.prototype.onStartEvent=function(){this.secsSinceStart=0};var Hotspot=pc.createScript("hotspot");Hotspot.attributes.add("cameraEntity",{type:"entity",title:"Camera Entity"}),Hotspot.attributes.add("radius",{type:"number",title:"Radius"}),Hotspot.attributes.add("fadeDropOff",{type:"number",default:.4,title:"Fade Drop Off",description:"When to start fading out hotspot relative to the camera direction. 1 for when hotspot is directly inline with the camera. 0 for never."}),Hotspot.prototype.initialize=function(){pc.app.root.findByName("MainCamera")&&this.change_pic(),this.judge=!0,this.zuohoumen_kaiguan=0,this.zuoqianmen_kaiguan=0,this.youqianmen_kaiguan=0,this.youhoumen_kaiguan=0,this.houbeimen_kaiguan=0,this.hitArea=new pc.BoundingSphere(this.entity.getPosition(),this.radius),this.ray=new pc.Ray,this.defaultForwardDirection=this.entity.forward.clone(),this.directionToCamera=new pc.Vec3,this.sprite=this.entity.children[0],this.meshInstances=[];for(var e=this.sprite.findComponents("render"),n=0;n<e.length;++n)for(var t=e[n].meshInstances,o=0;o<t.length;o++)this.meshInstances.push(t[o]);this.app.mouse.on(pc.EVENT_MOUSEDOWN,this.onMouseDown,this),this.app.touch&&this.app.touch.on(pc.EVENT_TOUCHSTART,this.onTouchStart,this),this.on("destroy",(function(){this.app.mouse.off(pc.EVENT_MOUSEDOWN,this.onMouseDown,this),this.app.touch&&this.app.touch.off(pc.EVENT_TOUCHSTART,this.onTouchStart,this)}),this)},Hotspot.prototype.update=function(e){var n=this.cameraEntity.getPosition();this.entity.lookAt(n),this.directionToCamera.sub2(n,this.entity.getPosition()),this.directionToCamera.normalize();var t=this.directionToCamera.dot(this.defaultForwardDirection);if(t<0)this.sprite.enabled&&(this.sprite.enabled=!1);else{this.sprite.enabled||(this.sprite.enabled=!0);for(var o=this.meshInstances,a=pc.math.clamp(t/this.fadeDropOff,0,1),i=0;i<o.length;++i)o[i].setParameter("material_opacity",a)}},Hotspot.prototype.change_pic=function(){var e=1,n=setInterval((function(){pc.app.root.findByName("MainCamera")?(e>=1&&e<10&&(pc.app.root.findByName("zuoqianmen").children[0].element.texture=pc.app.assets.find("redian02_00"+e.toString()+".png").resource,pc.app.root.findByName("zuohoumen").children[0].element.texture=pc.app.assets.find("redian02_00"+e.toString()+".png").resource,pc.app.root.findByName("youqianmen").children[0].element.texture=pc.app.assets.find("redian02_00"+e.toString()+".png").resource,pc.app.root.findByName("youhoumen").children[0].element.texture=pc.app.assets.find("redian02_00"+e.toString()+".png").resource,pc.app.root.findByName("tianchuang").children[0].element.texture=pc.app.assets.find("redian02_00"+e.toString()+".png").resource,pc.app.root.findByName("houbeimen").children[0].element.texture=pc.app.assets.find("redian02_00"+e.toString()+".png").resource),e>=10&&e<51&&(pc.app.root.findByName("zuoqianmen").children[0].element.texture=pc.app.assets.find("redian02_0"+e.toString()+".png").resource,pc.app.root.findByName("zuohoumen").children[0].element.texture=pc.app.assets.find("redian02_0"+e.toString()+".png").resource,pc.app.root.findByName("youqianmen").children[0].element.texture=pc.app.assets.find("redian02_0"+e.toString()+".png").resource,pc.app.root.findByName("youhoumen").children[0].element.texture=pc.app.assets.find("redian02_0"+e.toString()+".png").resource,pc.app.root.findByName("tianchuang").children[0].element.texture=pc.app.assets.find("redian02_0"+e.toString()+".png").resource,pc.app.root.findByName("houbeimen").children[0].element.texture=pc.app.assets.find("redian02_0"+e.toString()+".png").resource),51==e&&(e=1),e++):clearInterval(n)}),20)},Hotspot.prototype.open_zuoqianmen=function(e){var n,t=this.app.root.findByName("p_door01");if(e&&this.zuoqianmen_kaiguan%2==0&&pc.app.root.findByName("zuoqianmen").enabled){pc.app.root.findByName("zuoqianmen").enabled=!1,n=0;var o=setInterval((function(){t.getLocalEulerAngles().y>=-60?t.setLocalEulerAngles(0,n-=.26,0):(clearInterval(o),pc.app.root.findByName("zuoqianmen").enabled=!0,pc.app.root.findByName("zuoqianmen").script.hotspot.zuoqianmen_kaiguan++)}),2)}else if(!e&&this.zuoqianmen_kaiguan%2==1&&pc.app.root.findByName("zuoqianmen").enabled){pc.app.root.findByName("zuoqianmen").enabled=!1,n=t.getLocalEulerAngles().y;var a=setInterval((function(){t.getLocalEulerAngles().y<=0?t.setLocalEulerAngles(0,n+=.26,0):(clearInterval(a),pc.app.root.findByName("zuoqianmen").enabled=!0,pc.app.root.findByName("zuoqianmen").script.hotspot.zuoqianmen_kaiguan++)}),2)}},Hotspot.prototype.open_zuohoumen=function(e){var n,t=this.app.root.findByName("p_door03");if(e&&this.zuohoumen_kaiguan%2==0&&pc.app.root.findByName("zuohoumen").enabled){pc.app.root.findByName("zuohoumen").enabled=!1,n=0;var o=setInterval((function(){t.getLocalEulerAngles().y>=-60?t.setLocalEulerAngles(0,n-=.26,0):(pc.app.root.findByName("zuohoumen").enabled=!0,clearInterval(o),pc.app.root.findByName("zuohoumen").script.hotspot.zuohoumen_kaiguan++)}),2)}else if(!1===e&&this.zuohoumen_kaiguan%2==1&&pc.app.root.findByName("zuohoumen").enabled){pc.app.root.findByName("zuohoumen").enabled=!1,n=t.getLocalEulerAngles().y;var a=setInterval((function(){t.getLocalEulerAngles().y<=0?t.setLocalEulerAngles(0,n+=.26,0):(clearInterval(a),pc.app.root.findByName("zuohoumen").enabled=!0,pc.app.root.findByName("zuohoumen").script.hotspot.zuohoumen_kaiguan++)}),2)}},Hotspot.prototype.open_youqianmen=function(e){var n,t=this.app.root.findByName("p_door02");if(e&&this.youqianmen_kaiguan%2==0&&pc.app.root.findByName("youqianmen").enabled){pc.app.root.findByName("youqianmen").enabled=!1,n=0;var o=setInterval((function(){t.getLocalEulerAngles().y<=60?t.setLocalEulerAngles(0,n+=.26,0):(clearInterval(o),pc.app.root.findByName("youqianmen").enabled=!0,pc.app.root.findByName("youqianmen").script.hotspot.youqianmen_kaiguan++)}),2)}else if(!e&&this.youqianmen_kaiguan%2==1&&pc.app.root.findByName("youqianmen").enabled){pc.app.root.findByName("youqianmen").enabled=!1,n=t.getLocalEulerAngles().y;var a=setInterval((function(){t.getLocalEulerAngles().y>=0?t.setLocalEulerAngles(0,n-=.26,0):(clearInterval(a),pc.app.root.findByName("youqianmen").enabled=!0,pc.app.root.findByName("youqianmen").script.hotspot.youqianmen_kaiguan++)}),2)}},Hotspot.prototype.open_youhoumen=function(e){var n,t=this.app.root.findByName("p_door04");if(e&&this.youhoumen_kaiguan%2==0&&pc.app.root.findByName("youhoumen").enabled){pc.app.root.findByName("youhoumen").enabled=!1,n=0;var o=setInterval((function(){t.getLocalEulerAngles().y<=60?t.setLocalEulerAngles(0,n+=.26,0):(clearInterval(o),pc.app.root.findByName("youhoumen").enabled=!0,pc.app.root.findByName("youhoumen").script.hotspot.youhoumen_kaiguan++)}),2)}else if(!e&&this.youhoumen_kaiguan%2==1&&pc.app.root.findByName("youhoumen").enabled){pc.app.root.findByName("youhoumen").enabled=!1,n=t.getLocalEulerAngles().y;var a=setInterval((function(){t.getLocalEulerAngles().y>=0?t.setLocalEulerAngles(0,n-=.26,0):(clearInterval(a),pc.app.root.findByName("youhoumen").enabled=!0,pc.app.root.findByName("youhoumen").script.hotspot.youhoumen_kaiguan++)}),2)}},Hotspot.prototype.open_tianchuang=function(e){var n,t,o=this.app.root.findByName("p_tianchuang01"),a=this.app.root.findByName("p_tianchuang02");if(e){pc.app.root.findByName("tianchuang").enabled=!1,n=-.2044961005449295,t=1.666,y08=1.658,x08=-.152,x09=.252,x10=.104;var i=setInterval((function(){if(o.getPosition().x<=.104)o.setPosition(n+=.001,1.612720012664795,-.013015533797442913);else{clearInterval(i);var e=setInterval((function(){if(a.getPosition().y>=1.658)a.setPosition(-.152,t-=1e-4,.008);else{clearInterval(e);var n=setInterval((function(){a.getPosition().x<=.252?a.setPosition(x08+=.001,t,.008):(clearInterval(n),pc.app.root.findByName("tianchuang").enabled=!0)}),2)}}),2)}}),2)}else{pc.app.root.findByName("tianchuang").enabled=!1;var p=setInterval((function(){if(a.getPosition().x>=-.152)a.setPosition(x09-=.001,1.658,.008);else{clearInterval(p);var e=setInterval((function(){if(a.getPosition().y<=1.666)a.setPosition(-.152,y08+=1e-4,.008);else{clearInterval(e);var n=setInterval((function(){o.getPosition().x>=-.204?o.setPosition(x10-=.001,1.612720012664795,-.013015533797442913):(clearInterval(n),pc.app.root.findByName("tianchuang").enabled=!0)}),2)}}),2)}}),2)}},Hotspot.prototype.open_houbeimen=function(e){var n,t=pc.app.root.findByName("p_houbeimen05"),o=pc.app.root.findByName("p_chenggan01"),a=pc.app.root.findByName("p_chenggan02"),i=pc.app.root.findByName("houbeimen_copy");if(e&&this.houbeimen_kaiguan%2==0&&!0===pc.app.root.findByName("houbeimen").enabled){pc.app.root.findByName("houbeimen").enabled=!1,n=0,o.animation.play("chenggan01.glb"),t.animation.play("houbeimen05.glb"),a.animation.play("chenggan02.glb"),setTimeout((function(){o.animation.speed=0,a.animation.speed=0,t.animation.speed=0}),1e3);var p=setInterval((function(){i.getLocalEulerAngles().z<=64?i.setLocalEulerAngles(0,0,n+=.285):(clearInterval(p),pc.app.root.findByName("houbeimen").enabled=!0,pc.app.root.findByName("houbeimen").script.hotspot.houbeimen_kaiguan++)}),2)}else if(!e&&this.houbeimen_kaiguan%2==1&&!0===pc.app.root.findByName("houbeimen").enabled){pc.app.root.findByName("houbeimen").enabled=!1,o.animation.speed=1,a.animation.speed=1,t.animation.speed=1,n=i.getLocalEulerAngles().z;var r=setInterval((function(){i.getLocalEulerAngles().z>=0?i.setLocalEulerAngles(0,0,n-=.26):(clearInterval(r),pc.app.root.findByName("houbeimen").enabled=!0,pc.app.root.findByName("houbeimen").script.hotspot.houbeimen_kaiguan++)}),2)}},Hotspot.prototype.doRayCast=function(e){if(this.sprite.enabled&&(this.cameraEntity.camera.screenToWorld(e.x,e.y,this.cameraEntity.camera.farClip,this.ray.direction),this.ray.origin.copy(this.cameraEntity.getPosition()),this.ray.direction.sub(this.ray.origin).normalize(),this.hitArea.intersectsRay(this.ray)))switch(this.entity.name){case"zuoqianmen":this.app.root.findByName("p_door01").getEulerAngles().y>=-30?this.open_zuoqianmen(!0):this.open_zuoqianmen(!1);break;case"zuohoumen":this.app.root.findByName("p_door03").getEulerAngles().y>=-30?this.open_zuohoumen(!0):this.open_zuohoumen(!1);break;case"youqianmen":this.app.root.findByName("p_door02").getEulerAngles().y<=30?this.open_youqianmen(!0):this.open_youqianmen(!1);break;case"youhoumen":this.app.root.findByName("p_door04").getEulerAngles().y<=30?this.open_youhoumen(!0):this.open_youhoumen(!1);break;case"houbeimen":1==this.app.root.findByName("p_chenggan01").animation.speed?this.open_houbeimen(!0):this.open_houbeimen(!1);break;case"tianchuang":this.app.root.findByName("p_tianchuang01").getPosition().x<=-.052?this.open_tianchuang(!0):this.open_tianchuang(!1)}},Hotspot.prototype.onMouseDown=function(e){e.button==pc.MOUSEBUTTON_LEFT&&this.doRayCast(e)},Hotspot.prototype.onTouchStart=function(e){1==e.touches.length&&(this.doRayCast(e.touches[0]),e.event.preventDefault())};var Blob=pc.createScript("blob");Blob.attributes.add("asset",{type:"asset",array:!0,default:[]}),Blob.attributes.add("scale",{type:"number",default:1}),Blob.attributes.add("opacity",{type:"number",default:1,min:0,max:1}),Blob.prototype.initialize=function(){this.texture=null,this.asset[0]&&(this.textureAsset=this.app.assets.find(this.asset[0].name),this.setTexture(this.textureAsset.resource),this.opacityOld=this.opacity,this.scaleOld=this.scale)},Blob.prototype.setTexture=function(t){this.texture=t,this.entity.model.model.meshInstances[0].setParameter("texture_diffuseMap",this.texture),this.entity.model.model.meshInstances[0].setParameter("opacity",this.opacity),this.entity.model.model.meshInstances[0].setParameter("scale",this.scale)},Blob.prototype.update=function(t){this.opacityOld!==this.opacity&&(this.opacityOld=this.opacity,this.entity.model.model.meshInstances[0].setParameter("opacity",this.opacity)),this.scaleOld!==this.scale&&(this.scaleOld=this.scale,this.entity.model.model.meshInstances[0].setParameter("scale",this.scale))};var Blobs=pc.createScript("blobs");Blobs.prototype.initialize=function(){this.list=[],this.isOn=!1,this.material=new pc.BasicMaterial,this.material.updateShader=function(t){this.shader=new pc.Shader(t,{attributes:{vertex_position:"POSITION"},vshader:"                 attribute vec3 vertex_position;\n                 uniform mat4 matrix_model;\n                 uniform mat4 matrix_projection;\n                 uniform mat4 matrix_view;\n                 uniform mat3 matrix_normal;\n                 uniform float scale;\n                 varying vec2 vUv0;\n                 void main(void)\n                 {\n                     vec3 normal = normalize(matrix_normal * vec3(0, 1, 0));\n                     float d = max(0.0, (dot(vec3(matrix_view[0][2], matrix_view[1][2], matrix_view[2][2]), normal) - 0.35) * (1.0 / (1.0 - 0.35)));\n                     mat4 modelMatrix = matrix_view * matrix_model;\n                     modelMatrix[0][0] = 1.0;\n                     modelMatrix[0][1] = 0.0;\n                     modelMatrix[0][2] = 0.0;\n                     modelMatrix[1][0] = 0.0;\n                     modelMatrix[1][1] = 1.0;\n                     modelMatrix[1][2] = 0.0;\n                     modelMatrix[2][0] = 0.0;\n                     modelMatrix[2][1] = 0.0;\n                     modelMatrix[2][2] = 1.0;\n                     vec4 positionW = modelMatrix * vec4(vertex_position * scale * d, 1.0);\n                     gl_Position = matrix_projection * positionW;\n                     vUv0 = vertex_position.xy + vec2(0.5);\n                     vUv0.y = 1.0 - vUv0.y;\n                 }\n",fshader:"                 precision highp float;\n                 varying vec2 vUv0;\n                 uniform float opacity;\n                 uniform sampler2D texture_diffuseMap;\n                 void main(void)\n                 {\n                     vec3 diffuse = texture2D(texture_diffuseMap, vUv0).rgb;\n                     if (diffuse.r * opacity < 0.001) discard;\n                     gl_FragColor = vec4(diffuse * opacity, 1.0);\n                 }\n"})},this.material.depthTest=!1,this.material.depthWrite=!1,this.material.blend=!0,this.material.blendSrc=1,this.material.blendDst=1,this.material.update();for(var t=[-.5,.5,0,.5,.5,0,.5,-.5,0,-.5,-.5,0],e=[2,1,0,0,3,2],i=new pc.VertexFormat(this.app.graphicsDevice,[{semantic:pc.SEMANTIC_POSITION,components:3,type:pc.ELEMENTTYPE_FLOAT32}]),n=new pc.VertexBuffer(this.app.graphicsDevice,i,t.length/3),r=new pc.VertexIterator(n),a=0;a<t.length/3;a++)r.element[pc.SEMANTIC_POSITION].set(t[3*a],t[3*a+1],t[3*a+2]),r.next();r.end();var o=new pc.IndexBuffer(this.app.graphicsDevice,pc.INDEXFORMAT_UINT16,e.length);new Uint16Array(o.lock()).set(e),o.unlock();var s=new pc.Mesh;s.vertexBuffer=n,s.indexBuffer[0]=o,s.primitive[0].type=pc.PRIMITIVE_TRIANGLES,s.primitive[0].base=0,s.primitive[0].count=e.length,s.primitive[0].indexed=!0;var p=new pc.GraphNode,l=new pc.MeshInstance(p,s,this.material);l.updateKey();var c=new pc.Model;c.graph=p,c.meshInstances=[l],this.processEntity(this.entity,c),this.app.on("deng:toggle",(function(t){this.switch()}),this)},Blobs.prototype.processEntity=function(t,e){t.script&&t.script.blob&&(this.list.push(t),t.model.model=e.clone());for(var i=t.getChildren(),n=0;n<i.length;n++)this.processEntity(i[n],e)},Blobs.prototype.switch=function(){this.isOn=!this.isOn;for(var t=0;t<this.list.length;t++)this.list[t].enabled=this.isOn};var OrbitCamera=pc.createScript("orbitCamera");OrbitCamera.attributes.add("distanceMax",{type:"number",default:0,title:"Distance Max",description:"Setting this at 0 will give an infinite distance limit"}),OrbitCamera.attributes.add("distanceMin",{type:"number",default:0,title:"Distance Min"}),OrbitCamera.attributes.add("pitchAngleMax",{type:"number",default:90,title:"Pitch Angle Max (degrees)"}),OrbitCamera.attributes.add("pitchAngleMin",{type:"number",default:-90,title:"Pitch Angle Min (degrees)"}),OrbitCamera.attributes.add("inertiaFactor",{type:"number",default:0,title:"Inertia Factor",description:"Higher value means that the camera will continue moving after the user has stopped dragging. 0 is fully responsive."}),OrbitCamera.attributes.add("focusEntity",{type:"entity",title:"Focus Entity",description:"Entity for the camera to focus on. If blank, then the camera will use the whole scene"}),OrbitCamera.attributes.add("frameOnStart",{type:"boolean",default:!0,title:"Frame on Start",description:'Frames the entity or scene at the start of the application."'}),Object.defineProperty(OrbitCamera.prototype,"distance",{get:function(){return this._targetDistance},set:function(t){this._targetDistance=this._clampDistance(t)}}),Object.defineProperty(OrbitCamera.prototype,"pitch",{get:function(){return this._targetPitch},set:function(t){this._targetPitch=this._clampPitchAngle(t)}}),Object.defineProperty(OrbitCamera.prototype,"yaw",{get:function(){return this._targetYaw},set:function(t){this._targetYaw=t;var i=(this._targetYaw-this._yaw)%360;this._targetYaw=i>180?this._yaw-(360-i):i<-180?this._yaw+(360+i):this._yaw+i}}),Object.defineProperty(OrbitCamera.prototype,"pivotPoint",{get:function(){return this._pivotPoint},set:function(t){this._pivotPoint.copy(t)}}),OrbitCamera.prototype.focus=function(t){this._buildAabb(t,0);var i=this._modelsAabb.halfExtents,e=Math.max(i.x,Math.max(i.y,i.z));e/=Math.tan(.5*this.entity.camera.fov*pc.math.DEG_TO_RAD),e*=2,this.distance=e,this._removeInertia(),this._pivotPoint.copy(this._modelsAabb.center)},OrbitCamera.distanceBetween=new pc.Vec3,OrbitCamera.prototype.resetAndLookAtPoint=function(t,i){this.pivotPoint.copy(i),this.entity.setPosition(t),this.entity.lookAt(i);var e=OrbitCamera.distanceBetween;e.sub2(i,t),this.distance=e.length(),this.pivotPoint.copy(i);var a=this.entity.getRotation();this.yaw=this._calcYaw(a),this.pitch=this._calcPitch(a,this.yaw),this._removeInertia(),this._updatePosition()},OrbitCamera.prototype.resetAndLookAtEntity=function(t,i){this._buildAabb(i,0),this.resetAndLookAtPoint(t,this._modelsAabb.center)},OrbitCamera.prototype.reset=function(t,i,e){this.pitch=i,this.yaw=t,this.distance=e,this._removeInertia()},OrbitCamera.prototype.initialize=function(){var t=this,onWindowResize=function(){t._checkAspectRatio()};window.addEventListener("resize",onWindowResize,!1),this._checkAspectRatio(),this._modelsAabb=new pc.BoundingBox,this._buildAabb(this.focusEntity||this.app.root,0),this.entity.lookAt(this._modelsAabb.center),this._pivotPoint=new pc.Vec3,this._pivotPoint.copy(this._modelsAabb.center);var i=this.entity.getRotation();if(this._yaw=this._calcYaw(i),this._pitch=this._clampPitchAngle(this._calcPitch(i,this._yaw)),this.entity.setLocalEulerAngles(this._pitch,this._yaw,0),this._distance=0,this._targetYaw=this._yaw,this._targetPitch=this._pitch,this.frameOnStart)this.focus(this.focusEntity||this.app.root);else{var e=new pc.Vec3;e.sub2(this.entity.getPosition(),this._pivotPoint),this._distance=this._clampDistance(e.length())}this._targetDistance=this._distance,this.on("attr:distanceMin",(function(t,i){this._targetDistance=this._clampDistance(this._distance)})),this.on("attr:distanceMax",(function(t,i){this._targetDistance=this._clampDistance(this._distance)})),this.on("attr:pitchAngleMin",(function(t,i){this._targetPitch=this._clampPitchAngle(this._pitch)})),this.on("attr:pitchAngleMax",(function(t,i){this._targetPitch=this._clampPitchAngle(this._pitch)})),this.on("attr:focusEntity",(function(t,i){this.frameOnStart?this.focus(t||this.app.root):this.resetAndLookAtEntity(this.entity.getPosition(),t||this.app.root)})),this.on("attr:frameOnStart",(function(t,i){t&&this.focus(this.focusEntity||this.app.root)})),this.on("destroy",(function(){window.removeEventListener("resize",onWindowResize,!1)}))},OrbitCamera.prototype.update=function(t){var i=0===this.inertiaFactor?1:Math.min(t/this.inertiaFactor,1);this._distance=pc.math.lerp(this._distance,this._targetDistance,i),this._yaw=pc.math.lerp(this._yaw,this._targetYaw,i),this._pitch=pc.math.lerp(this._pitch,this._targetPitch,i),this._updatePosition()},OrbitCamera.prototype._updatePosition=function(){this.entity.setLocalPosition(0,0,0),this.entity.setLocalEulerAngles(this._pitch,this._yaw,0);var t=this.entity.getPosition();t.copy(this.entity.forward),t.scale(-this._distance),t.add(this.pivotPoint),this.entity.setPosition(t)},OrbitCamera.prototype._removeInertia=function(){this._yaw=this._targetYaw,this._pitch=this._targetPitch,this._distance=this._targetDistance},OrbitCamera.prototype._checkAspectRatio=function(){var t=this.app.graphicsDevice.height,i=this.app.graphicsDevice.width;this.entity.camera.horizontalFov=t>i},OrbitCamera.prototype._buildAabb=function(t,i){var e=0;if(t.model){var a=t.model.meshInstances;for(e=0;e<a.length;e++)0===i?this._modelsAabb.copy(a[e].aabb):this._modelsAabb.add(a[e].aabb),i+=1}for(e=0;e<t.children.length;++e)i+=this._buildAabb(t.children[e],i);return i},OrbitCamera.prototype._calcYaw=function(t){var i=new pc.Vec3;return t.transformVector(pc.Vec3.FORWARD,i),Math.atan2(-i.x,-i.z)*pc.math.RAD_TO_DEG},OrbitCamera.prototype._clampDistance=function(t){return this.distanceMax>0?pc.math.clamp(t,this.distanceMin,this.distanceMax):Math.max(t,this.distanceMin)},OrbitCamera.prototype._clampPitchAngle=function(t){return pc.math.clamp(t,-this.pitchAngleMax,-this.pitchAngleMin)},OrbitCamera.quatWithoutYaw=new pc.Quat,OrbitCamera.yawOffset=new pc.Quat,OrbitCamera.prototype._calcPitch=function(t,i){var e=OrbitCamera.quatWithoutYaw,a=OrbitCamera.yawOffset;a.setFromEulerAngles(0,-i,0),e.mul2(a,t);var s=new pc.Vec3;return e.transformVector(pc.Vec3.FORWARD,s),Math.atan2(s.y,-s.z)*pc.math.RAD_TO_DEG};var TouchInput=pc.createScript("touchInput");TouchInput.attributes.add("orbitSensitivity",{type:"number",default:.4,title:"Orbit Sensitivity",description:"How fast the camera moves around the orbit. Higher is faster"}),TouchInput.attributes.add("distanceSensitivity",{type:"number",default:.2,title:"Distance Sensitivity",description:"How fast the camera moves in and out. Higher is faster"}),TouchInput.prototype.initialize=function(){this.orbitCamera=this.entity.script.orbitCamera,this.lastTouchPoint=new pc.Vec2,this.lastPinchMidPoint=new pc.Vec2,this.lastPinchDistance=0,this.orbitCamera&&this.app.touch&&(this.app.touch.on(pc.EVENT_TOUCHSTART,this.onTouchStartEndCancel,this),this.app.touch.on(pc.EVENT_TOUCHEND,this.onTouchStartEndCancel,this),this.app.touch.on(pc.EVENT_TOUCHCANCEL,this.onTouchStartEndCancel,this),this.app.touch.on(pc.EVENT_TOUCHMOVE,this.onTouchMove,this),this.on("destroy",(function(){this.app.touch.off(pc.EVENT_TOUCHSTART,this.onTouchStartEndCancel,this),this.app.touch.off(pc.EVENT_TOUCHEND,this.onTouchStartEndCancel,this),this.app.touch.off(pc.EVENT_TOUCHCANCEL,this.onTouchStartEndCancel,this),this.app.touch.off(pc.EVENT_TOUCHMOVE,this.onTouchMove,this)})))},TouchInput.prototype.getPinchDistance=function(t,i){var o=t.x-i.x,n=t.y-i.y;return Math.sqrt(o*o+n*n)},TouchInput.prototype.calcMidPoint=function(t,i,o){o.set(i.x-t.x,i.y-t.y),o.scale(.5),o.x+=t.x,o.y+=t.y},TouchInput.prototype.onTouchStartEndCancel=function(t){var i=t.touches;1==i.length?this.lastTouchPoint.set(i[0].x,i[0].y):2==i.length&&(this.lastPinchDistance=this.getPinchDistance(i[0],i[1]),this.calcMidPoint(i[0],i[1],this.lastPinchMidPoint))},TouchInput.fromWorldPoint=new pc.Vec3,TouchInput.toWorldPoint=new pc.Vec3,TouchInput.worldDiff=new pc.Vec3,TouchInput.prototype.pan=function(t){var i=TouchInput.fromWorldPoint,o=TouchInput.toWorldPoint,n=TouchInput.worldDiff,h=this.entity.camera,c=this.orbitCamera.distance;h.screenToWorld(t.x,t.y,c,i),h.screenToWorld(this.lastPinchMidPoint.x,this.lastPinchMidPoint.y,c,o),n.sub2(o,i),this.orbitCamera.pivotPoint.add(n)},TouchInput.pinchMidPoint=new pc.Vec2,TouchInput.prototype.onTouchMove=function(t){var i=TouchInput.pinchMidPoint,o=t.touches;if(1==o.length){var n=o[0];this.orbitCamera.pitch-=(n.y-this.lastTouchPoint.y)*this.orbitSensitivity,this.orbitCamera.yaw-=(n.x-this.lastTouchPoint.x)*this.orbitSensitivity,this.lastTouchPoint.set(n.x,n.y)}else if(2==o.length){var h=this.getPinchDistance(o[0],o[1]),c=h-this.lastPinchDistance;this.lastPinchDistance=h,this.orbitCamera.distance-=c*this.distanceSensitivity*.1*(.1*this.orbitCamera.distance),this.calcMidPoint(o[0],o[1],i)}};var LookCamera=pc.createScript("lookCamera");LookCamera.attributes.add("mouseLookSensitivity",{type:"number",default:0,title:"Mouse Look Sensitivity"}),LookCamera.attributes.add("touchLookSensitivity",{type:"number",default:0,title:"Touch Look Sensitivity"}),LookCamera.attributes.add("snappinessFactor",{type:"number",default:.1,title:"Snappiness Factor",description:"Lower is faster"}),LookCamera.prototype.initialize=function(){this._tempQuat1=new pc.Quat,this._tempQuat2=new pc.Quat,this._tempVec3_1=new pc.Vec3;var t=this.entity.getLocalRotation();this.ey=this.getYaw(t)*pc.math.RAD_TO_DEG,this.ex=this.getPitch(t,this.ey)*pc.math.RAD_TO_DEG,this.targetEx=this.ex,this.targetEy=this.ey,this.moved=!1,this.app.mouse.disableContextMenu(),this.lastTouchPosition=new pc.Vec2,this.addEventCallbacks(),this.on("destroy",(function(){this.removeEventCallbacks()}),this)},LookCamera.prototype.addEventCallbacks=function(){this.app.mouse&&this.app.mouse.on(pc.EVENT_MOUSEMOVE,this.onMouseMove,this),this.app.touch&&(this.app.touch.on(pc.EVENT_TOUCHSTART,this.onTouchStart,this),this.app.touch.on(pc.EVENT_TOUCHMOVE,this.onTouchMove,this))},LookCamera.prototype.removeEventCallbacks=function(){this.app.mouse&&this.app.mouse.off(pc.EVENT_MOUSEMOVE,this.onMouseMove,this),this.app.touch&&(this.app.touch.off(pc.EVENT_TOUCHSTART,this.onTouchStart,this),this.app.touch.off(pc.EVENT_TOUCHMOVE,this.onTouchMove,this))},LookCamera.prototype.update=function(t){var o=1;this.snappinessFactor>0&&(o=t/this.snappinessFactor),this.ex=pc.math.lerp(this.ex,this.targetEx,o),this.ey=pc.math.lerp(this.ey,this.targetEy,o),this.entity.setLocalEulerAngles(this.ex,this.ey,0)},LookCamera.prototype.moveCamera=function(t,o,e){this.moved?(this.targetEx+=o*e,this.targetEx=pc.math.clamp(this.targetEx,-90,90),this.targetEy+=t*e):this.moved=!0},LookCamera.prototype.onMouseMove=function(t){this.app.mouse.isPressed(pc.MOUSEBUTTON_LEFT)&&this.moveCamera(t.dx,t.dy,this.mouseLookSensitivity)},LookCamera.prototype.onTouchStart=function(t){var o=t.touches[0];this.lastTouchPosition.set(o.x,o.y)},LookCamera.prototype.onTouchMove=function(t){var o=t.touches[0];this.moveCamera(o.x-this.lastTouchPosition.x,o.y-this.lastTouchPosition.y,this.touchLookSensitivity),this.lastTouchPosition.set(o.x,o.y)},LookCamera.prototype.getYaw=function(){var t=this.entity.forward.clone();return Math.atan2(-t.x,-t.z)},LookCamera.prototype.getPitch=function(t,o){var e=this._tempQuat1,i=this._tempQuat2;i.setFromEulerAngles(0,-o,0),e.mul2(i,t);var s=this._tempVec3_1;return e.transformVector(pc.Vec3.FORWARD,s),Math.atan2(s.y,-s.z)};var OffsetFloor=pc.createScript("offsetFloor");OffsetFloor.attributes.add("speed",{type:"number",default:.03}),OffsetFloor.prototype.initialize=function(){this.offsetX=0},OffsetFloor.prototype.update=function(t){this.offsetX-=this.speed,this.entity.model.material._diffuseMapOffset=new pc.Vec2(0,this.offsetX),this.entity.model.material.update()};pc.script.createLoadingScreen((function(e){var t,a;t=["body {","    background-color: black;","}","#application-splash-wrapper {","    position: absolute;","    top: 0;","    left: 0;","    height: 100%;","    width: 100%;","    background-color: black;","}","#application-splash {","    position: absolute;","    top: calc(50% - 300px);","    width: 600px;","    left: calc(50% - 300px);","}","#application-splash img {","    width: 100%;","}","#progress-bar-container {","    margin: 20px auto 0 auto;","    height: 2px;","    width: 100%;","    background-color: #1d292c;","}","#progress-bar {","    width: 0%;","    height: 100%;","    background-color: #f60;","}","@media (max-width: 480px) {","    #application-splash {","        width: 170px;","        left: calc(50% - 85px);","    }","}"].join("\n"),(a=document.createElement("style")).type="text/css",a.styleSheet?a.styleSheet.cssText=t:a.appendChild(document.createTextNode(t)),document.head.appendChild(a),function(){var e=document.createElement("div");e.id="application-splash-wrapper",document.body.appendChild(e);var t=document.createElement("div");t.id="application-splash",e.appendChild(t),t.style.display="none"}(),e.on("preload:start",(function(){var t,a=document.getElementById("application-splash"),n=10,o=document.createElement("img");t=e.assets.find("T19 FL MY_Web GL_0001.jpg");var p=setInterval((function(){t=e.assets.find("T19 FL MY_Web GL_00"+n.toString()+".jpg"),o.src=t.getFileUrl(),50===(n+=2)&&(n=51,clearInterval(p))}),200);t&&(a.childNodes.length>0?a.insertBefore(o,a.childNodes[0]):a.appendChild(o),o.onload=function(){a.style.display="block"})})),e.on("preload:end",(function(){e.off("preload:progress")})),e.on("start",(function(){var e=document.getElementById("application-splash-wrapper");e.parentElement.removeChild(e)}))}));var Halo=pc.createScript("halo");Halo.attributes.add("camera",{type:"entity"}),Halo.attributes.add("unidirectional",{type:"boolean",default:!1}),Halo.tmp=new pc.Vec3,Halo.prototype.initialize=function(){this.plane=this.entity.children[0],this.parent=this.entity.parent},Halo.prototype.update=function(t){var a=Halo.tmp;a.copy(this.parent.forward).scale(-1);var e=this.plane.render.meshInstances;if(this.camera)if(this.entity.lookAt(this.camera.getPosition()),this.unidirectional){var i=-1*a.dot(this.camera.forward);i<0&&(i=0),e[0].setParameter("material_opacity",i)}else e[0].setParameter("material_opacity",1)};var ChangingScenes=pc.createScript("changingScenes");ChangingScenes.attributes.add("sceneName",{type:"string",default:"",title:"Scene Name to Load"}),ChangingScenes.prototype.initialize=function(e){},ChangingScenes.prototype.loadScene=function(e){var n=this.app.root.findByName("Root"),t=this.app.scenes.find(e);this.app.scenes.loadSceneHierarchy(t.url,(function(e,t){e?console.error(e):n.destroy()}))};var ShowDemo2=pc.createScript("showDemo2");ShowDemo2.attributes.add("css",{type:"asset",assetType:"css",title:"CSS Asset"}),ShowDemo2.attributes.add("html",{type:"asset",assetType:"html",title:"HTML Asset"}),ShowDemo2.prototype.initialize=function(){var e=this;this.app.on("loading1",(function(){e.show()})),this.app.on("loading2",(function(){e.hide()}))},ShowDemo2.prototype.show=function(){console.log("ceshi");var e=document.createElement("style");document.head.appendChild(e),e.innerHTML=this.css.resource||"",this.div=document.createElement("div"),this.div.innerHTML=this.html.resource||"",this.div.setAttribute("id","divv"),document.body.appendChild(this.div);var t;this.div.querySelector("#img0");function windowHeight(){var e=document.documentElement.clientHeight;t=document.getElementById("d");try{t.style.height=e+"px"}catch(e){}}window.onload=windowHeight;try{setInterval(windowHeight,500)}catch(e){}},ShowDemo2.prototype.hide=function(){document.getElementById("d").parentElement.removeChild(document.getElementById("d"))};var EnterCar=pc.createScript("enterCar");EnterCar.CLOSED=0,EnterCar.OPEN=1,EnterCar.prototype.initialize=function(){this.state=EnterCar.CLOSED,this.desiredState=EnterCar.CLOSED,this.percent=1,this.speed=.25,this.mainCamera=this.app.root.findByName("MainCamera"),this.camLpos=new pc.Vec3,this.camLrot=new pc.Quat,this.camFov=0,this.qStartPivot=new pc.Quat,this.qOpenPivot=new pc.Quat(.08898384042448368,-.7074410607015866,-.09054051236260335,-.6952779569336579),this.door=null,this.qClosedL=new pc.Quat(0,0,0,1),this.qOpenL=null,this.inside=null,this.app._openDoor=this},EnterCar.prototype.toggle=function(t,i,a,e){this.state===this.desiredState&&(this.door=t||this.door,this.qOpenL=i||this.qOpenL,this.inside=e||this.inside,this.qOpenPivot=a||this.qOpenPivot,this.percent=0,this.desiredState=1-this.state,this.entity.fire("stateStart"),pc.app.isEnter=-1,this.desiredState===EnterCar.OPEN&&(this.app._carPivotRotation.enabled=!1,this.qStartPivot.copy(this.app._carPivotRotation.entity.getLocalRotation()),this.camLpos.copy(this.mainCamera.getLocalPosition()),this.camLrot.copy(this.mainCamera.getLocalRotation()),this.camFov=this.mainCamera.camera.fov))},EnterCar.prototype.update=function(t){if(this.state!==this.desiredState){var i=this.qClosedL,a=this.qOpenL;this.percent=Math.min(this.percent+t*this.speed,1),1===this.percent&&(this.state=this.desiredState,this.state==EnterCar.CLOSED&&(this.app._autoDistance.weight=1),this.entity.fire("state",this.state),pc.app.isEnter=this.state!==EnterCar.CLOSED?1:0);var e,s,o,h=Math.min(4*this.percent,1),r=pc.math.clamp(4*this.percent-2,0,1),n=this.door.getLocalRotation();if(h<1?n.slerp(i,a,this.smoothstepC(h)):n.slerp(a,i,this.smoothstepC(r)),this.door.setLocalRotation(n),this.desiredState===EnterCar.OPEN){(n=this.app._carPivotRotation.entity.getLocalRotation()).slerp(this.qStartPivot,this.qOpenPivot,this.smoothstepC(h)),e=Math.max(1.176*this.percent-.176,0),o=this.smoothstepC(pc.math.clamp((e-.1)/.1,0,1)),e=this.smoothstepC(e),this.app._autoDistance.enabled=e<=0,s=this.mainCamera.getPosition();var p=this.inside.getPosition();s.lerp(s,p,e),this.mainCamera.setPosition(s),this.mainCamera.camera.fov=pc.math.lerp(this.mainCamera.camera.fov,70,e),this.app._mouseLook.enabled=e>0,this.app._mouseLook.weight=e}else e=Math.max(1.176*this.percent-.176,0),o=this.smoothstepC(pc.math.clamp(e/.1,0,1)),e=this.smoothstepC(e),s=this.mainCamera.getLocalPosition(),e<.3&&(s.lerp(s,this.camLpos,e),this.mainCamera.setLocalPosition(s)),(n=this.mainCamera.getLocalRotation()).slerp(n,this.camLrot,e),this.mainCamera.setLocalRotation(n),this.mainCamera.camera.fov=pc.math.lerp(this.mainCamera.camera.fov,this.camFov,e),this.app._carPivotRotation.enabled=e>0,this.app._autoDistance.enabled=e>0,this.app._carPivotRotation.weight=e,this.app._autoDistance.weight=Math.max(e-.3,0)/.7,this.app._mouseLook.enabled=o<1,this.app._mouseLook.weight=1-o}},EnterCar.prototype.smoothstepC=function(t){return t*t*(3-2*t)};var ShowDemo3=pc.createScript("showDemo3");ShowDemo3.attributes.add("css",{type:"asset",assetType:"css",title:"CSS Asset"}),ShowDemo3.attributes.add("html",{type:"asset",assetType:"html",title:"HTML Asset"}),ShowDemo3.prototype.initialize=function(){var e=this;this.app.on("loadding1",(function(){e.show()})),this.app.on("loading2",(function(){e.hide()}))},ShowDemo3.prototype.show=function(){console.log("ceshi");var e=document.createElement("style");document.head.appendChild(e),e.innerHTML=this.css.resource||"",this.div=document.createElement("div"),this.div.innerHTML=this.html.resource||"",this.div.setAttribute("id","divv"),document.body.appendChild(this.div);var t;this.div.querySelector("#img0");function windowHeight(){var e=document.documentElement.clientHeight;t=document.getElementById("d");try{t.style.height=e+"px"}catch(e){}}window.onload=windowHeight;try{setInterval(windowHeight,500)}catch(e){}},ShowDemo3.prototype.hide=function(){document.getElementById("d").parentElement.removeChild(document.getElementById("d"))};function FxaaEffect(e){pc.PostEffect.call(this,e);var o={aPosition:pc.SEMANTIC_POSITION},t=["attribute vec2 aPosition;","","void main(void)","{","    gl_Position = vec4(aPosition, 0.0, 1.0);","}"].join("\n"),a=["precision "+e.precision+" float;","","uniform sampler2D uColorBuffer;","uniform vec2 uResolution;","","#define FXAA_REDUCE_MIN   (1.0/128.0)","#define FXAA_REDUCE_MUL   (1.0/8.0)","#define FXAA_SPAN_MAX     8.0","","void main()","{","    vec3 rgbNW = texture2D( uColorBuffer, ( gl_FragCoord.xy + vec2( -1.0, -1.0 ) ) * uResolution ).xyz;","    vec3 rgbNE = texture2D( uColorBuffer, ( gl_FragCoord.xy + vec2( 1.0, -1.0 ) ) * uResolution ).xyz;","    vec3 rgbSW = texture2D( uColorBuffer, ( gl_FragCoord.xy + vec2( -1.0, 1.0 ) ) * uResolution ).xyz;","    vec3 rgbSE = texture2D( uColorBuffer, ( gl_FragCoord.xy + vec2( 1.0, 1.0 ) ) * uResolution ).xyz;","    vec4 rgbaM  = texture2D( uColorBuffer,  gl_FragCoord.xy  * uResolution );","    vec3 rgbM  = rgbaM.xyz;","    float opacity  = rgbaM.w;","","    vec3 luma = vec3( 0.299, 0.587, 0.114 );","","    float lumaNW = dot( rgbNW, luma );","    float lumaNE = dot( rgbNE, luma );","    float lumaSW = dot( rgbSW, luma );","    float lumaSE = dot( rgbSE, luma );","    float lumaM  = dot( rgbM,  luma );","    float lumaMin = min( lumaM, min( min( lumaNW, lumaNE ), min( lumaSW, lumaSE ) ) );","    float lumaMax = max( lumaM, max( max( lumaNW, lumaNE) , max( lumaSW, lumaSE ) ) );","","    vec2 dir;","    dir.x = -((lumaNW + lumaNE) - (lumaSW + lumaSE));","    dir.y =  ((lumaNW + lumaSW) - (lumaNE + lumaSE));","","    float dirReduce = max( ( lumaNW + lumaNE + lumaSW + lumaSE ) * ( 0.25 * FXAA_REDUCE_MUL ), FXAA_REDUCE_MIN );","","    float rcpDirMin = 1.0 / ( min( abs( dir.x ), abs( dir.y ) ) + dirReduce );","    dir = min( vec2( FXAA_SPAN_MAX, FXAA_SPAN_MAX), max( vec2(-FXAA_SPAN_MAX, -FXAA_SPAN_MAX), dir * rcpDirMin)) * uResolution;","","    vec3 rgbA = 0.5 * (","        texture2D( uColorBuffer, gl_FragCoord.xy  * uResolution + dir * ( 1.0 / 3.0 - 0.5 ) ).xyz +","        texture2D( uColorBuffer, gl_FragCoord.xy  * uResolution + dir * ( 2.0 / 3.0 - 0.5 ) ).xyz );","","    vec3 rgbB = rgbA * 0.5 + 0.25 * (","        texture2D( uColorBuffer, gl_FragCoord.xy  * uResolution + dir * -0.5 ).xyz +","        texture2D( uColorBuffer, gl_FragCoord.xy  * uResolution + dir * 0.5 ).xyz );","","    float lumaB = dot( rgbB, luma );","","    if ( ( lumaB < lumaMin ) || ( lumaB > lumaMax ) )","    {","        gl_FragColor = vec4( rgbA, opacity );","    }","    else","    {","        gl_FragColor = vec4( rgbB, opacity );","    }","}"].join("\n");this.fxaaShader=new pc.Shader(e,{attributes:o,vshader:t,fshader:a}),this.resolution=new Float32Array(2)}FxaaEffect.prototype=Object.create(pc.PostEffect.prototype),FxaaEffect.prototype.constructor=FxaaEffect,Object.assign(FxaaEffect.prototype,{render:function(e,o,t){var a=this.device,r=a.scope;this.resolution[0]=1/e.width,this.resolution[1]=1/e.height,r.resolve("uResolution").setValue(this.resolution),r.resolve("uColorBuffer").setValue(e.colorBuffer),pc.drawFullscreenQuad(a,o,this.vertexBuffer,this.fxaaShader,t)}});var Fxaa=pc.createScript("fxaa");Fxaa.prototype.initialize=function(){this.effect=new FxaaEffect(this.app.graphicsDevice);var e=this.entity.camera.postEffects;e.addEffect(this.effect),this.on("state",(function(o){o?e.addEffect(this.effect):e.removeEffect(this.effect)})),this.on("destroy",(function(){e.removeEffect(this.effect)}))};var Dpi=pc.createScript("dpi");Dpi.prototype.initialize=function(){/(Android\s(5))|(OS\s8_)/.test(navigator.userAgent)&&(this.app.graphicsDevice.maxPixelRatio=window.devicePixelRatio)};